% NEURONSLURMCluster
% Ignores wall clock time
classdef NEURONSLURMCluster < SLURMCluster & NeuronMachine
    methods
        function obj = NEURONSLURMCluster(wallClockTime,...
                                   hostID, hostOS, ~, ~, ...
                                   baseDir, scratchDir,...
                                   simFileSourceDir, custFileSourceDir,...
                                   modelFileSourceDir,...
                                   simType, numSims,...
                                   xCompilationMachine,...
                                   xCompilationScratchDir,...
                                   auth, log, notificationSet, dataFunc,...
                                   queueData, ~, ~, numNodes)
            md = dataFunc();
            obj = obj@NeuronMachine(md);

            obj = obj@SLURMCluster(wallClockTime,...
                                   hostID, hostOS, '', '',...
                                   baseDir, scratchDir,...
                                   simFileSourceDir, custFileSourceDir,...
                                   modelFileSourceDir,...
                                   simType, numSims,...
                                   xCompilationMachine,...
                                   xCompilationScratchDir,...
                                   auth, log, notificationSet, dataFunc,...
                                   queueData, '', '', numNodes);
         end
        
        % ----------
        % Neuron model processing is machine-dependent. On TACC we compile
        % the model files before the job submission. Subclass and override
        % this if you need to!
        % This is called from SimNeuron.
        % Refer to NeuroManagerStaging.xlsx
        function str = getCompileNeuronModelFilesStrPhaseP(obj, simulation)
            str = obj.getModelFileCompileStr(simulation);
        end
        
        % ----------
        % Neuron model processing is machine-dependent. 
        % This is called from SimNeuron.
        % Refer to NeuroManagerStaging.xlsx
        function str = getCompileNeuronModelFilesStrPhaseD(obj, simulation)  %#ok<INUSD>
            str = '';  
        end
        
        % ----------
        % Override the job file here if you like
        %function jobfilename = PreRunCreateJobFile(obj, scratchdir, jobroot, remoterundir, runcommand)
            % ...
        %end
    end
    
    %     methods (Access=protected)        
%     % CreateDownloadExpectFile.m
%     % Can be overridden here for localization.
% %     function CreateDownloadExpectFile(obj, hostdir, targetpath)
% %         ...
% %     end
%     end

end
